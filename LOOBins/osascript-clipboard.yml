name: osascript-clipboard
author: Cedric Owens (cedowens)
short_description: Use osascript to dump clipboard (pasteboard) contents to stdout.
full_description: Calls /usr/bin/osascript -e 'return (the clipboard)' which returns clipboard contents.
created: 2023-04-19
example_use_cases:
- name: Use osascript in this manner to gather sensitive clipboard data
  description: A bash loop that gathers clipboard contents over a defined time perioid.
  code: while true; do echo $(osascript -e 'return (the clipboard)') >> clipdata.txt; sleep 10; done
  tactics:
    - Collection
    - Credential Access
  tags:
  - clipboard
  - bash
  - one;liner
paths:
- /usr/bin/osascript
detections:
- name: Command Line Argument Detection (args contain osascript AND -e AND clipboard)
  url: n/a
resources:
- name: 'Using macOS Internals for Post Exploitation'
  url: https://medium.com/red-teaming-with-a-blue-team-mentality/using-macos-internals-for-post-exploitation-b5faaa11e121
acknowledgements:
- n/a

